SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/tez/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/tez/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
Connecting to jdbc:hive2://cluster-bd20-m:10000
Connected to: Apache Hive (version 3.1.3)
Driver: Hive JDBC (version 3.1.3)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://cluster-bd20-m:10000> -- ✅ Check total number of reviews
0: jdbc:hive2://cluster-bd20-m:10000> SELECT COUNT(*) AS total_reviews FROM helpful_reviews;
INFO  : Compiling command(queryId=hive_20250617131346_1a5cb28b-3aaf-49c3-bf81-fbdeeae4593f): SELECT COUNT(*) AS total_reviews FROM helpful_reviews
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:total_reviews, type:bigint, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20250617131346_1a5cb28b-3aaf-49c3-bf81-fbdeeae4593f); Time taken: 0.246 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20250617131346_1a5cb28b-3aaf-49c3-bf81-fbdeeae4593f): SELECT COUNT(*) AS total_reviews FROM helpful_reviews
INFO  : Query ID = hive_20250617131346_1a5cb28b-3aaf-49c3-bf81-fbdeeae4593f
INFO  : Total jobs = 1
INFO  : Launching Job 1 out of 1
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Subscribed to counters: [] for queryId: hive_20250617131346_1a5cb28b-3aaf-49c3-bf81-fbdeeae4593f
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: SELECT COUNT(*) AS total_r...helpful_reviews (Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1750097936025_0024)

----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container        INITED      1          0        0        1       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/02  [>>--------------------------] 0%    ELAPSED TIME: 5.81 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container        INITED      1          0        0        1       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/02  [>>--------------------------] 0%    ELAPSED TIME: 6.82 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container        INITED      1          0        0        1       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/02  [>>--------------------------] 0%    ELAPSED TIME: 7.83 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/02  [>>--------------------------] 0%    ELAPSED TIME: 9.34 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/02  [>>--------------------------] 0%    ELAPSED TIME: 10.85 s    
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/02  [>>--------------------------] 0%    ELAPSED TIME: 12.36 s    
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 01/02  [=============>>-------------] 50%   ELAPSED TIME: 13.87 s    
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2 ...... container     SUCCEEDED      1          1        0        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/02  [==========================>>] 100%  ELAPSED TIME: 14.52 s    
----------------------------------------------------------------------------------------------
INFO  : Completed executing command(queryId=hive_20250617131346_1a5cb28b-3aaf-49c3-bf81-fbdeeae4593f); Time taken: 26.656 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+----------------+
| total_reviews  |
+----------------+
| 10001          |
+----------------+
1 row selected (27.038 seconds)
0: jdbc:hive2://cluster-bd20-m:10000> 
0: jdbc:hive2://cluster-bd20-m:10000> -- ✅ Find top 10 most-reviewed products (Filtered for relevance)
0: jdbc:hive2://cluster-bd20-m:10000> SELECT asin, COUNT(*) AS review_count 
. . . . . . . . . . . . . . . . . . > FROM helpful_reviews 
. . . . . . . . . . . . . . . . . . > WHERE text IS NOT NULL AND LENGTH(text) > 20  -- Exclude empty reviews
. . . . . . . . . . . . . . . . . . > GROUP BY asin 
. . . . . . . . . . . . . . . . . . > ORDER BY review_count DESC 
. . . . . . . . . . . . . . . . . . > LIMIT 10;
INFO  : Compiling command(queryId=hive_20250617131414_1e2ba3fe-0a3d-4ec9-9ab0-6a8639bfd6f4): SELECT asin, COUNT(*) AS review_count
FROM helpful_reviews
WHERE text IS NOT NULL AND LENGTH(text) > 20
GROUP BY asin
ORDER BY review_count DESC
LIMIT 10
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:asin, type:string, comment:null), FieldSchema(name:review_count, type:bigint, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20250617131414_1e2ba3fe-0a3d-4ec9-9ab0-6a8639bfd6f4); Time taken: 0.317 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20250617131414_1e2ba3fe-0a3d-4ec9-9ab0-6a8639bfd6f4): SELECT asin, COUNT(*) AS review_count
FROM helpful_reviews
WHERE text IS NOT NULL AND LENGTH(text) > 20
GROUP BY asin
ORDER BY review_count DESC
LIMIT 10
INFO  : Query ID = hive_20250617131414_1e2ba3fe-0a3d-4ec9-9ab0-6a8639bfd6f4
INFO  : Total jobs = 1
INFO  : Launching Job 1 out of 1
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Subscribed to counters: [] for queryId: hive_20250617131414_1e2ba3fe-0a3d-4ec9-9ab0-6a8639bfd6f4
INFO  : Session is already open
INFO  : Dag name: SELECT asin, COUNT(*) AS review_count
F...10 (Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1750097936025_0024)

----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 1.04 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 1.55 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 2.05 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 2.57 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 3.07 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 01/03  [========>>------------------] 33%   ELAPSED TIME: 3.58 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 3 ...... container     SUCCEEDED      1          1        0        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 03/03  [==========================>>] 100%  ELAPSED TIME: 3.95 s     
----------------------------------------------------------------------------------------------
INFO  : Completed executing command(queryId=hive_20250617131414_1e2ba3fe-0a3d-4ec9-9ab0-6a8639bfd6f4); Time taken: 4.467 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+-------------+---------------+
|    asin     | review_count  |
+-------------+---------------+
| B093T52595  | 4             |
| B00MH9RLAE  | 3             |
| B00000J0S3  | 3             |
| B01M0QFE35  | 3             |
| B07DLPXZCQ  | 3             |
| B0000U11LW  | 3             |
| B0992B1LYN  | 2             |
| B0040MK48W  | 2             |
| B00000DMCE  | 2             |
| B003DQ1AWK  | 2             |
+-------------+---------------+
10 rows selected (4.843 seconds)
0: jdbc:hive2://cluster-bd20-m:10000> 
0: jdbc:hive2://cluster-bd20-m:10000> -- ✅ Compute average ratings per product (Avoid bias from low review counts)
0: jdbc:hive2://cluster-bd20-m:10000> SELECT asin, AVG(rating) AS avg_rating, COUNT(*) AS review_count 
. . . . . . . . . . . . . . . . . . > FROM helpful_reviews 
. . . . . . . . . . . . . . . . . . > GROUP BY asin 
. . . . . . . . . . . . . . . . . . > HAVING review_count > 10  -- Corrected: Filtering after aggregation
. . . . . . . . . . . . . . . . . . > ORDER BY avg_rating DESC 
. . . . . . . . . . . . . . . . . . > LIMIT 10;
INFO  : Compiling command(queryId=hive_20250617131419_b7c374ae-6e0b-428c-98e6-8dbd1c0455e5): SELECT asin, AVG(rating) AS avg_rating, COUNT(*) AS review_count
FROM helpful_reviews
GROUP BY asin
HAVING review_count > 10
ORDER BY avg_rating DESC
LIMIT 10
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:asin, type:string, comment:null), FieldSchema(name:avg_rating, type:double, comment:null), FieldSchema(name:review_count, type:bigint, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20250617131419_b7c374ae-6e0b-428c-98e6-8dbd1c0455e5); Time taken: 0.181 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20250617131419_b7c374ae-6e0b-428c-98e6-8dbd1c0455e5): SELECT asin, AVG(rating) AS avg_rating, COUNT(*) AS review_count
FROM helpful_reviews
GROUP BY asin
HAVING review_count > 10
ORDER BY avg_rating DESC
LIMIT 10
INFO  : Query ID = hive_20250617131419_b7c374ae-6e0b-428c-98e6-8dbd1c0455e5
INFO  : Total jobs = 1
INFO  : Launching Job 1 out of 1
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Subscribed to counters: [] for queryId: hive_20250617131419_b7c374ae-6e0b-428c-98e6-8dbd1c0455e5
INFO  : Session is already open
INFO  : Dag name: SELECT asin, AVG(rating) AS avg_rating,...10 (Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1750097936025_0024)

----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 1.04 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 1.54 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 2.05 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 2.55 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 3 ...... container     SUCCEEDED      1          1        0        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 03/03  [==========================>>] 100%  ELAPSED TIME: 2.80 s     
----------------------------------------------------------------------------------------------
INFO  : Completed executing command(queryId=hive_20250617131419_b7c374ae-6e0b-428c-98e6-8dbd1c0455e5); Time taken: 3.304 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+-------------+--------------------+---------------+
|    asin     |     avg_rating     | review_count  |
+-------------+--------------------+---------------+
| B0120XRWLE  | 41.63157894736842  | 19            |
| B08GYJWLVH  | 25.75              | 12            |
+-------------+--------------------+---------------+
2 rows selected (3.585 seconds)
0: jdbc:hive2://cluster-bd20-m:10000> 
0: jdbc:hive2://cluster-bd20-m:10000> -- ✅ Most frequent words in review titles (Exclude common stopwords)
0: jdbc:hive2://cluster-bd20-m:10000> SELECT word, count 
. . . . . . . . . . . . . . . . . . > FROM title_word_counts 
. . . . . . . . . . . . . . . . . . > WHERE word NOT IN ('the', 'and', 'is', 'it', 'to', 'a', 'on', 'of', 'in')  -- Remove generic words
. . . . . . . . . . . . . . . . . . > ORDER BY count DESC 
. . . . . . . . . . . . . . . . . . > LIMIT 20;
INFO  : Compiling command(queryId=hive_20250617131422_ee2fb722-f189-4a66-9c82-9a380871119a): SELECT word, count
FROM title_word_counts
WHERE word NOT IN ('the', 'and', 'is', 'it', 'to', 'a', 'on', 'of', 'in')
ORDER BY count DESC
LIMIT 20
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:word, type:string, comment:null), FieldSchema(name:count, type:int, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20250617131422_ee2fb722-f189-4a66-9c82-9a380871119a); Time taken: 0.462 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20250617131422_ee2fb722-f189-4a66-9c82-9a380871119a): SELECT word, count
FROM title_word_counts
WHERE word NOT IN ('the', 'and', 'is', 'it', 'to', 'a', 'on', 'of', 'in')
ORDER BY count DESC
LIMIT 20
INFO  : Query ID = hive_20250617131422_ee2fb722-f189-4a66-9c82-9a380871119a
INFO  : Total jobs = 1
INFO  : Launching Job 1 out of 1
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Subscribed to counters: [] for queryId: hive_20250617131422_ee2fb722-f189-4a66-9c82-9a380871119a
INFO  : Session is already open
INFO  : Dag name: SELECT word, count
FROM title_word_coun...20 (Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1750097936025_0024)

INFO  : Completed executing command(queryId=hive_20250617131422_ee2fb722-f189-4a66-9c82-9a380871119a); Time taken: 0.575 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+-------+--------+
| word  | count  |
+-------+--------+
+-------+--------+
No rows selected (1.085 seconds)
0: jdbc:hive2://cluster-bd20-m:10000> 
0: jdbc:hive2://cluster-bd20-m:10000> -- ✅ Most frequent words in review text (Stopword optimization)
0: jdbc:hive2://cluster-bd20-m:10000> SELECT word, count 
. . . . . . . . . . . . . . . . . . > FROM text_word_counts 
. . . . . . . . . . . . . . . . . . > WHERE word NOT IN ('the', 'and', 'is', 'it', 'to', 'a', 'on', 'of', 'in')  
. . . . . . . . . . . . . . . . . . > ORDER BY count DESC 
. . . . . . . . . . . . . . . . . . > LIMIT 20;
INFO  : Compiling command(queryId=hive_20250617131423_aa9900cc-2e26-48bf-8b0c-8be8bd380714): SELECT word, count
FROM text_word_counts
WHERE word NOT IN ('the', 'and', 'is', 'it', 'to', 'a', 'on', 'of', 'in')
ORDER BY count DESC
LIMIT 20
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:word, type:string, comment:null), FieldSchema(name:count, type:int, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20250617131423_aa9900cc-2e26-48bf-8b0c-8be8bd380714); Time taken: 0.272 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20250617131423_aa9900cc-2e26-48bf-8b0c-8be8bd380714): SELECT word, count
FROM text_word_counts
WHERE word NOT IN ('the', 'and', 'is', 'it', 'to', 'a', 'on', 'of', 'in')
ORDER BY count DESC
LIMIT 20
INFO  : Query ID = hive_20250617131423_aa9900cc-2e26-48bf-8b0c-8be8bd380714
INFO  : Total jobs = 1
INFO  : Launching Job 1 out of 1
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Subscribed to counters: [] for queryId: hive_20250617131423_aa9900cc-2e26-48bf-8b0c-8be8bd380714
INFO  : Session is already open
INFO  : Dag name: SELECT word, count
FROM text_word_count...20 (Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1750097936025_0024)

INFO  : Completed executing command(queryId=hive_20250617131423_aa9900cc-2e26-48bf-8b0c-8be8bd380714); Time taken: 0.471 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+-------+--------+
| word  | count  |
+-------+--------+
+-------+--------+
No rows selected (0.78 seconds)
0: jdbc:hive2://cluster-bd20-m:10000> 
0: jdbc:hive2://cluster-bd20-m:10000> -- ✅ Percentage of verified purchases (Efficient calculation)
0: jdbc:hive2://cluster-bd20-m:10000> SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM helpful_reviews WHERE verified_purchase IS NOT NULL)) AS verified_percentage 
. . . . . . . . . . . . . . . . . . > FROM verified_reviews;
INFO  : Compiling command(queryId=hive_20250617131424_f41ac75a-a7b8-4e70-af4d-e0bd010e9f86): SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM helpful_reviews WHERE verified_purchase IS NOT NULL)) AS verified_percentage
FROM verified_reviews
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Warning: Map Join MAPJOIN[19][bigTable=?] in task 'Reducer 2' is a cross product
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:verified_percentage, type:decimal(38,15), comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20250617131424_f41ac75a-a7b8-4e70-af4d-e0bd010e9f86); Time taken: 0.483 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20250617131424_f41ac75a-a7b8-4e70-af4d-e0bd010e9f86): SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM helpful_reviews WHERE verified_purchase IS NOT NULL)) AS verified_percentage
FROM verified_reviews
INFO  : Query ID = hive_20250617131424_f41ac75a-a7b8-4e70-af4d-e0bd010e9f86
INFO  : Total jobs = 1
INFO  : Launching Job 1 out of 1
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Subscribed to counters: [] for queryId: hive_20250617131424_f41ac75a-a7b8-4e70-af4d-e0bd010e9f86
INFO  : Session is already open
INFO  : Dag name: SELECT (COUNT(*) * 100.0 ...verified_reviews (Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1750097936025_0024)

----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3            container        INITED      1          0        0        1       0       0  
Reducer 4        container        INITED      1          0        0        1       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/04  [>>--------------------------] 0%    ELAPSED TIME: 0.56 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3            container       RUNNING      1          0        1        0       0       0  
Reducer 4        container        INITED      1          0        0        1       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/04  [>>--------------------------] 0%    ELAPSED TIME: 1.07 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3            container       RUNNING      1          0        1        0       0       0  
Reducer 4        container        INITED      1          0        0        1       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/04  [>>--------------------------] 0%    ELAPSED TIME: 1.57 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4        container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 01/04  [========>>------------------] 33%   ELAPSED TIME: 2.07 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 2.58 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 3.09 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 3.59 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 4.10 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 4.61 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 5.11 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 5.62 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 6.13 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 6.63 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 7.14 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 7.64 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 8.15 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 8.65 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 9.15 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 02/04  [=================>>---------] 66%   ELAPSED TIME: 10.16 s    
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container     SUCCEEDED      0          0        0        0       0       0  
Map 3 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2 ...... container     SUCCEEDED      1          1        0        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 03/04  [==========================>>] 100%  ELAPSED TIME: 10.24 s    
----------------------------------------------------------------------------------------------
INFO  : Completed executing command(queryId=hive_20250617131424_f41ac75a-a7b8-4e70-af4d-e0bd010e9f86); Time taken: 10.811 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+----------------------+
| verified_percentage  |
+----------------------+
| NULL                 |
+----------------------+
1 row selected (11.366 seconds)
0: jdbc:hive2://cluster-bd20-m:10000> 
0: jdbc:hive2://cluster-bd20-m:10000> -- ✅ Find products with the highest percentage of helpful votes
0: jdbc:hive2://cluster-bd20-m:10000> SELECT asin, AVG(helpful_vote) AS avg_helpful_votes, COUNT(*) AS review_count 
. . . . . . . . . . . . . . . . . . > FROM helpful_reviews 
. . . . . . . . . . . . . . . . . . > WHERE helpful_vote > 0  -- Only consider reviews with helpful votes
. . . . . . . . . . . . . . . . . . > GROUP BY asin 
. . . . . . . . . . . . . . . . . . > ORDER BY avg_helpful_votes DESC 
. . . . . . . . . . . . . . . . . . > LIMIT 10;
INFO  : Compiling command(queryId=hive_20250617131436_6adb1fe0-50df-427f-966a-dd342b78bbce): SELECT asin, AVG(helpful_vote) AS avg_helpful_votes, COUNT(*) AS review_count
FROM helpful_reviews
WHERE helpful_vote > 0
GROUP BY asin
ORDER BY avg_helpful_votes DESC
LIMIT 10
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:asin, type:string, comment:null), FieldSchema(name:avg_helpful_votes, type:double, comment:null), FieldSchema(name:review_count, type:bigint, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20250617131436_6adb1fe0-50df-427f-966a-dd342b78bbce); Time taken: 0.323 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20250617131436_6adb1fe0-50df-427f-966a-dd342b78bbce): SELECT asin, AVG(helpful_vote) AS avg_helpful_votes, COUNT(*) AS review_count
FROM helpful_reviews
WHERE helpful_vote > 0
GROUP BY asin
ORDER BY avg_helpful_votes DESC
LIMIT 10
INFO  : Query ID = hive_20250617131436_6adb1fe0-50df-427f-966a-dd342b78bbce
INFO  : Total jobs = 1
INFO  : Launching Job 1 out of 1
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Subscribed to counters: [] for queryId: hive_20250617131436_6adb1fe0-50df-427f-966a-dd342b78bbce
INFO  : Session is already open
INFO  : Dag name: SELECT asin, AVG(helpful_vote) AS avg_h...10 (Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1750097936025_0024)

----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 1.26 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 1.76 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 2.27 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 2.78 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 3.28 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 3.78 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1            container       RUNNING      1          0        1        0       0       0  
Reducer 2        container        INITED      1          0        0        1       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 00/03  [>>--------------------------] 0%    ELAPSED TIME: 4.29 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2        container       RUNNING      1          0        1        0       0       0  
Reducer 3        container        INITED      1          0        0        1       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 01/03  [========>>------------------] 33%   ELAPSED TIME: 4.79 s     
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1 .......... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 2 ...... container     SUCCEEDED      1          1        0        0       0       0  
Reducer 3 ...... container     SUCCEEDED      1          1        0        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 03/03  [==========================>>] 100%  ELAPSED TIME: 4.84 s     
----------------------------------------------------------------------------------------------
INFO  : Completed executing command(queryId=hive_20250617131436_6adb1fe0-50df-427f-966a-dd342b78bbce); Time taken: 5.101 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+-------------+--------------------+---------------+
|    asin     | avg_helpful_votes  | review_count  |
+-------------+--------------------+---------------+
| 0439893577  | 5.0                | 1             |
| B0BXSWFXCS  | 5.0                | 1             |
| 0811871452  | 5.0                | 1             |
| 0735348200  | 5.0                | 1             |
| 0615638996  | 5.0                | 1             |
| 0735362602  | 5.0                | 1             |
| 0692370986  | 5.0                | 1             |
| B0BLS6LT6N  | 5.0                | 1             |
| 0786958650  | 5.0                | 1             |
| 0786959916  | 5.0                | 1             |
+-------------+--------------------+---------------+
10 rows selected (5.472 seconds)
0: jdbc:hive2://cluster-bd20-m:10000> 
0: jdbc:hive2://cluster-bd20-m:10000> Closing: 0: jdbc:hive2://cluster-bd20-m:10000
